# BLUX10K - Professional Developer Terminal Setup
# https://github.com/Justadudeinspace/blux10k

# Load install config if available
if [[ -f "$HOME/.config/blux10k/install.conf" ]]; then
    source "$HOME/.config/blux10k/install.conf"
fi

export BLUX10K_HOME="${BLUX10K_HOME:-$HOME/Projects/blux10k}"
export PATH="$HOME/.local/bin:$PATH"

# Zplug setup
if [[ -f "$HOME/.zplug/init.zsh" ]]; then
    source "$HOME/.zplug/init.zsh"

    zplug "zsh-users/zsh-syntax-highlighting", defer:2
    zplug "zsh-users/zsh-autosuggestions"
    zplug "zsh-users/zsh-completions"
    zplug "agkozak/zsh-z"
    zplug "romkatv/powerlevel10k", as:theme, depth:1

    if ! zplug check; then
        zplug install
    fi

    zplug load
fi

# Private environment
[[ -f "$HOME/.config/private/env.zsh" ]] && source "$HOME/.config/private/env.zsh"

# XDG base dirs
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CACHE_HOME="$HOME/.cache"
export XDG_STATE_HOME="$HOME/.local/state"

mkdir -p "$XDG_CACHE_HOME/zsh" "$XDG_STATE_HOME/zsh"

HISTFILE="${XDG_STATE_HOME}/zsh/history-$(date +%Y-%m)"
HISTSIZE=100000
SAVEHIST=100000

setopt INC_APPEND_HISTORY_TIME
setopt SHARE_HISTORY
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS
setopt HIST_IGNORE_SPACE

# BLUX10K modules
if [[ -d "$BLUX10K_HOME/modules" ]]; then
    for module in "$BLUX10K_HOME/modules/zsh/aliases.zsh" \
                  "$BLUX10K_HOME/modules/zsh/functions.zsh" \
                  "$BLUX10K_HOME/modules/update/update-core.zsh"; do
        [[ -f "$module" ]] && source "$module"
    done
fi

# Load additional configs
for config_file in "$HOME/.config/zsh"/*.zsh(N); do
    [[ -f "$config_file" ]] && source "$config_file"
done
