#!/usr/bin/env bash
# BLUX10K Neofetch Configuration v4.0.0
# Repository: https://github.com/Justadudeinspace/blux10k
#
# Usage:
#   - Run: neofetch --config /path/to/blux10k/configs/b10k.neofetch.conf
#   - Or copy to: ~/.config/neofetch/config.conf

# ============================================================================
# BLUX10K CONFIGURATION - PERFORMANCE OPTIMIZED
# ============================================================================

##--------- BLUX10K Color Scheme (Enhanced)
# Colors: 1=red, 2=green, 3=yellow, 4=blue, 5=magenta, 6=cyan, 7=white, 8=grey
colors=(4 6 2 3 1 5 7)

##--------- Display Configuration
# Hide/Show Fully qualified domain name.
title_fqdn="off"

# Display mode
display_mode="ascii"

# Image backend (ascii for performance, kitty/wezterm for graphics)
image_backend="ascii"

# Gap between image and text
gap=3

##--------- Performance Settings
# Enable/disable slow features
blux10k_performance_mode="auto"  # auto, on, off
blux10k_async_loading="on"
blux10k_cache_enabled="on"
blux10k_cache_dir="${XDG_CACHE_HOME:-$HOME/.cache}/blux10k/neofetch"

##--------- BLUX10K Custom Functions (Enhanced)

# BLUX10K Version Information
blux10k_version_info() {
    echo "v4.0.0"
}

# Plugin Manager Detection
detect_plugin_manager() {
    if command -v zinit >/dev/null 2>&1 && [[ -d ~/.local/share/zinit ]]; then
        echo "Zinit ($(zinit list 2>/dev/null | wc -l) plugins)"
    elif command -v zplug >/dev/null 2>&1 && [[ -d ~/.zplug ]]; then
        echo "Zplug ($(zplug list --installed 2>/dev/null | wc -l) plugins)"
    elif [[ -d ~/.zgenom ]]; then
        echo "Zgenom"
    elif [[ -d ~/.zplugin ]]; then
        echo "Zplugin"
    else
        echo "None"
    fi
}

# ZSH Performance Metrics
zsh_performance_metrics() {
    local metrics=()
    
    # Startup time if available
    if [[ -n "$_total_startup_time" ]]; then
        metrics+=("${_total_startup_time}ms startup")
    fi
    
    # History size
    if command -v fc >/dev/null 2>&1; then
        local hist_size=$(fc -l 1 | wc -l 2>/dev/null || echo "0")
        metrics+=("$hist_size history")
    fi
    
    # PATH optimization
    if [[ -n "$path" ]]; then
        metrics+=("${#path[@]} PATH dirs")
    fi
    
    echo "${metrics[*]}"
}

# Development Tools Status (Enhanced)
dev_tools_status() {
    local tools_status=()
    
    # Python
    if command -v python3 >/dev/null 2>&1; then
        local py_version=$(python3 --version 2>/dev/null | cut -d' ' -f2)
        tools_status+=("üêç $py_version")
    fi
    
    # Node.js
    if command -v node >/dev/null 2>&1; then
        local node_version=$(node --version 2>/dev/null | sed 's/v//')
        tools_status+=("‚¨¢ $node_version")
    fi
    
    # Rust
    if command -v rustc >/dev/null 2>&1; then
        local rust_version=$(rustc --version 2>/dev/null | cut -d' ' -f2)
        tools_status+=("ü¶Ä $rust_version")
    fi
    
    # Go
    if command -v go >/dev/null 2>&1; then
        local go_version=$(go version 2>/dev/null | awk '{for (i=1; i<=NF; i++) if ($i ~ /^go[0-9]/) {sub(/^go/, "", $i); print $i; exit}}')
        tools_status+=("üêπ $go_version")
    fi
    
    # Docker
    if command -v docker >/dev/null 2>&1; then
        tools_status+=("üê≥")
    fi
    
    # Kubernetes
    if command -v kubectl >/dev/null 2>&1; then
        tools_status+=("‚éà")
    fi
    
    echo "${tools_status[*]}"
}

# Terminal Enhancements Status
terminal_enhancements_status() {
    local enhancements=()
    
    # FZF
    command -v fzf >/dev/null 2>&1 && enhancements+=("FZF")
    
    # Zoxide
    command -v zoxide >/dev/null 2>&1 && enhancements+=("Zoxide")
    
    # Bat
    command -v bat >/dev/null 2>&1 && enhancements+=("Bat")
    
    # Eza
    command -v eza >/dev/null 2>&1 && enhancements+=("Eza")
    
    # Modern tools
    command -v rg >/dev/null 2>&1 && enhancements+=("Ripgrep")
    command -v fd >/dev/null 2>&1 && enhancements+=("FD")
    
    if [[ ${#enhancements[@]} -gt 0 ]]; then
        echo "${enhancements[*]}"
    else
        echo "Basic"
    fi
}

# System Readiness Check (Enhanced)
blux10k_ready_check() {
    local issues=0
    local warnings=0
    local messages=()
    
    # Critical checks
    if ! command -v zsh >/dev/null 2>&1; then
        messages+=("‚ùå ZSH not installed")
        ((issues++))
    fi
    
    if ! command -v git >/dev/null 2>&1; then
        messages+=("‚ùå Git not installed")
        ((issues++))
    fi
    
    # Warning checks
    if ! command -v nvim >/dev/null 2>&1; then
        messages+=("‚ö†Ô∏è  NeoVim not found")
        ((warnings++))
    fi
    
    if [[ ! -d "$HOME/.local/share/zinit" ]] && [[ ! -d "$HOME/.zplug" ]]; then
        messages+=("‚ö†Ô∏è  Plugin manager not installed")
        ((warnings++))
    fi
    
    if [[ ! -f "$HOME/.p10k.zsh" ]]; then
        messages+=("‚ö†Ô∏è  Powerlevel10k not configured")
        ((warnings++))
    fi
    
    # Performance checks
    if [[ ${#path[@]} -gt 50 ]]; then
        messages+=("‚ö†Ô∏è  Large PATH (${#path[@]} entries)")
        ((warnings++))
    fi
    
    if [[ $issues -eq 0 && $warnings -eq 0 ]]; then
        echo "‚úÖ System Ready"
    elif [[ $issues -eq 0 && $warnings -gt 0 ]]; then
        echo "‚ö†Ô∏è  $warnings warning(s)"
    else
        echo "‚ùå $issues issue(s), $warnings warning(s)"
    fi
}

# Package Manager Detection
package_manager_info() {
    local pkg_count="N/A"
    
    if command -v apt >/dev/null 2>&1; then
        pkg_count=$(dpkg-query -f '${binary:Package}\n' -W 2>/dev/null | wc -l)
        echo "APT ($pkg_count)"
    elif command -v pacman >/dev/null 2>&1; then
        pkg_count=$(pacman -Qq 2>/dev/null | wc -l)
        echo "Pacman ($pkg_count)"
    elif command -v dnf >/dev/null 2>&1; then
        pkg_count=$(rpm -qa 2>/dev/null | wc -l)
        echo "DNF ($pkg_count)"
    elif command -v brew >/dev/null 2>&1; then
        pkg_count=$(brew list 2>/dev/null | wc -l)
        echo "Homebrew ($pkg_count)"
    else
        echo "Unknown"
    fi
}

# Shell Information (Enhanced)
shell_info() {
    local shell_name="${SHELL##*/}"
    local shell_version
    
    case "$shell_name" in
        zsh)
            shell_version=$(zsh --version | cut -d' ' -f2)
            ;;
        bash)
            shell_version=$(bash --version | head -n1 | cut -d' ' -f4)
            ;;
        fish)
            shell_version=$(fish --version | cut -d' ' -f3)
            ;;
        *)
            shell_version="Unknown"
            ;;
    esac
    
    echo "$shell_name $shell_version"
}

# ============================================================================
# CUSTOM PRINT INFO FUNCTION (Enhanced for BLUX10K v4.0.0)
# ============================================================================

print_info() {
    # Performance optimization: Cache expensive operations
    local cache_file="${blux10k_cache_dir}/system_info.cache"
    local cache_age=300  # 5 minutes
    
    if [[ "$blux10k_cache_enabled" == "on" ]] && \
       [[ -f "$cache_file" ]] && \
       [[ $(($(date +%s) - $(stat -c %Y "$cache_file" 2>/dev/null || echo 0))) -lt $cache_age ]]; then
        # Use cached version for fast display
        cat "$cache_file"
        return 0
    fi
    
    # Create cache directory
    mkdir -p "$(dirname "$cache_file")"
    
    {
        # BLUX10K Header with version
        prin "$(color 4)‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
        info "$(color 6)üÖë  BLUX10K" "$(blux10k_version_info)"
        prin "$(color 4)‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
        
        # BLUX10K Accent Line (Dynamic based on system status)
        local accent_colors=(4 6 2 3 1 5 7)
        local accent_line=""
        for color in "${accent_colors[@]}"; do
            accent_line+="$(color $color)‚ñ¨"
        done
        prin "$accent_line"
        
        # ========================= SYSTEM INFORMATION =========================
        prin "$(color 4)‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄÔÜí $(color 6)SYSTEM INFORMATION$(color 4) ÔÜí‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
        
        # Operating System
        info "$(color 4)üñ•  OS" os
        info "$(color 4)‚îÇ ‚îú$(color 6)ÔÖº " distro
        info "$(color 4)‚îÇ ‚îú$(color 2)Óòï " kernel
        info "$(color 4)‚îÇ ‚îú$(color 3)Ô£ñ " "$(package_manager_info)"
        info "$(color 4)‚îÇ ‚îî$(color 1)Ôäí " "$(shell_info)"
        
        prin "$(color 4)‚îÇ"
        
        # Desktop Environment
        info "$(color 6)üñº  DE/WM" wm
        info "$(color 6)‚îÇ ‚îú$(color 2)Ôñ™ " theme
        info "$(color 6)‚îÇ ‚îú$(color 3)Ôñ™ " icons
        info "$(color 6)‚îÇ ‚îî$(color 1)ÔÑ† " term
        
        prin "$(color 4)‚îÇ"
        
        # Hardware Information
        info "$(color 2)üíª Hardware" model
        info "$(color 2)‚îÇ ‚îú$(color 6)Ô°ö " cpu
        info "$(color 2)‚îÇ ‚îú$(color 3)Ô°∏ " gpu
        info "$(color 2)‚îÇ ‚îú$(color 1)Ôãõ " memory
        info "$(color 2)‚îÇ ‚îú$(color 4)Ôôè " uptime
        info "$(color 2)‚îÇ ‚îî$(color 5)ÔÄæ " resolution
        
        prin "$(color 4)‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄÔÜí $(color 6)SYSTEM STATUS$(color 4) ÔÜí‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
        
        # ========================= BLUX10K ENVIRONMENT =========================
        prin "$(color 4)‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄÔÜí $(color 6)BLUX10K ENVIRONMENT$(color 4) ÔÜí‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
        
        # BLUX10K Core Information
        info "$(color 6)üÖë  BLUX10K" "$(blux10k_ready_check)"
        info "$(color 6)‚îÇ ‚îú$(color 2)üì¶ " "$(detect_plugin_manager)"
        info "$(color 6)‚îÇ ‚îú$(color 3)‚ö° " "$(zsh_performance_metrics)"
        info "$(color 6)‚îÇ ‚îú$(color 1)üìö " "echo '$(fc -l 1 | wc -l 2>/dev/null || echo 0) history'"
        info "$(color 6)‚îÇ ‚îî$(color 4)üîß " "echo '${#path[@]} PATH dirs'"
        
        prin "$(color 4)‚îÇ"
        
        # Development Tools
        info "$(color 2)üõ†  Development" "echo '$(dev_tools_status)'"
        info "$(color 2)‚îÇ ‚îú$(color 6)üêô " "command -v git >/dev/null && git --version 2>/dev/null | cut -d' ' -f3 || echo 'Not found'"
        info "$(color 2)‚îÇ ‚îú$(color 3)Óò´ " "command -v nvim >/dev/null && nvim --version 2>/dev/null | head -n1 | cut -d' ' -f2 || echo 'Not found'"
        info "$(color 2)‚îÇ ‚îú$(color 1)Ôáí " "command -v curl >/dev/null && curl --version 2>/dev/null | head -n1 | cut -d' ' -f2 || echo 'Not found'"
        info "$(color 2)‚îÇ ‚îî$(color 4)ÔÄô " "command -v wget >/dev/null && wget --version 2>/dev/null | head -n1 | cut -d' ' -f3 || echo 'Not found'"
        
        prin "$(color 4)‚îÇ"
        
        # Terminal Enhancements
        info "$(color 3)üîß  Terminal" "echo '$(terminal_enhancements_status)'"
        info "$(color 3)‚îÇ ‚îú$(color 6)üé® " "echo '${TERM:-Unknown}'"
        info "$(color 3)‚îÇ ‚îú$(color 2)üìÅ " "pwd | sed \"s|$HOME|~|\""
        info "$(color 3)‚îÇ ‚îú$(color 1)üïí " "date '+%H:%M:%S %Z'"
        info "$(color 3)‚îÇ ‚îî$(color 4)üåê " "curl -s --connect-timeout 2 https://api.ipify.org || echo 'Offline'"
        
        prin "$(color 4)‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄÔÜí $(color 6)PERFORMANCE$(color 4) ÔÜí‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
        
        # ========================= PERFORMANCE METRICS =========================
        prin "$(color 4)‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄÔÜí $(color 6)PERFORMANCE METRICS$(color 4) ÔÜí‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
        
        # System Load
        local load_avg=$(uptime | awk -F'load average:' '{print $2}')
        info "$(color 6)üìä  Load Avg" "echo '$load_avg'"
        
        # Disk Usage
        if command -v df >/dev/null 2>&1; then
            local disk_info=$(df -h / | awk 'NR==2 {print $4 "/" $2 " (" $5 ")"}')
            info "$(color 2)üíæ  Disk (/) " "echo '$disk_info'"
        fi
        
        # Temperature (if available)
        if [[ -f /sys/class/thermal/thermal_zone0/temp ]]; then
            local temp=$(($(cat /sys/class/thermal/thermal_zone0/temp) / 1000))
            info "$(color 3)üå°  CPU Temp" "echo '${temp}¬∞C'"
        elif command -v sensors >/dev/null 2>&1; then
            local temp=$(sensors | awk '/Package id 0:/ {match($0, /[0-9.]+/); if (RSTART) {print substr($0, RSTART, RLENGTH); exit}}')
            info "$(color 3)üå°  CPU Temp" "echo '${temp}¬∞C'"
        fi
        
        # Battery (if available)
        if [[ -d /sys/class/power_supply/BAT* ]] || [[ "$(uname)" == "Darwin" ]]; then
            if command -v acpi >/dev/null 2>&1; then
                local battery=$(acpi -b | grep -Eo '[0-9]+%' | head -1)
                info "$(color 1)üîã  Battery" "echo '$battery'"
            elif [[ "$(uname)" == "Darwin" ]]; then
                local battery=$(pmset -g batt | grep -Eo '[0-9]+%' | head -1)
                info "$(color 1)üîã  Battery" "echo '$battery'"
            fi
        fi
        
        # Network Status
        if command -v ip >/dev/null 2>&1; then
            local network_ip=$(ip route get 1 2>/dev/null | awk '{print $7; exit}')
            info "$(color 4)üåê  Local IP" "echo '${network_ip:-Disconnected}'"
        fi
        
        prin "$(color 4)‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄÔÜí $(color 6)SYSTEM READY$(color 4) ÔÜí‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
        
        # BLUX10K Footer
        echo
        prin "$accent_line"
        
        # BLUX10K Motto and Help
        prin "$(color 6)           BLUX10K v4.0.0: Enhanced Terminal Environment"
        prin "$(color 2)           Performance Optimized | Security Hardened | Developer Ready"
        prin "$(color 4)           Run 'b10k --help' for available commands | 'neofetch --help' for options"
        
        # Quick Stats Summary
        echo
        local stats=()
        [[ -n "$load_avg" ]] && stats+=("Load: $load_avg")
        [[ -n "$disk_info" ]] && stats+=("Disk: $(echo "$disk_info" | awk '{print $1}') free")
        [[ -n "$battery" ]] && stats+=("Battery: $battery")
        
        if [[ ${#stats[@]} -gt 0 ]]; then
            prin "$(color 3)üìà Quick Stats: $(IFS=' | '; echo "${stats[*]}")"
        fi
        
    } | tee "$cache_file" 2>/dev/null
    
    return 0
}

# ============================================================================
# PERFORMANCE OPTIMIZATION SETTINGS
# ============================================================================

##--------- Kernel Configuration
# Shorten the output of the kernel function.
kernel_shorthand="on"

##--------- Distro Configuration
# Shorten the output of the distro function
distro_shorthand="off"

# Show/Hide OS Architecture.
os_arch="on"

##--------- Uptime Configuration
# Shorten the output of the uptime function
uptime_shorthand="on"

##--------- Memory Configuration
# Show memory percentage in output.
memory_percent="off"

# Change memory output unit.
memory_unit="mib"

##--------- Packages Configuration
# Show/Hide Package Manager names.
package_managers="on"

##--------- Shell Configuration
# Show the path to $SHELL
shell_path="off"

# Show $SHELL version
shell_version="on"

##--------- CPU Configuration
# CPU speed type
speed_type="bios_limit"

# CPU speed shorthand
speed_shorthand="on"

# Enable/Disable CPU brand in output.
cpu_brand="on"

# CPU Speed - Hide/Show CPU speed.
cpu_speed="on"

# CPU Cores - Display CPU cores in output
cpu_cores="logical"

# CPU Temperature - Hide/Show CPU temperature.
cpu_temp="auto"

##--------- GPU Configuration
# Enable/Disable GPU Brand
gpu_brand="on"

# Which GPU to display
gpu_type="all"

##--------- Resolution Configuration
# Display refresh rate next to each monitor
refresh_rate="off"

##--------- Gtk Theme / Icons / Font Configuration
# Shorten output of GTK Theme / Icons / Font
gtk_shorthand="on"

# Enable/Disable gtk2 Theme / Icons / Font
gtk2="on"

# Enable/Disable gtk3 Theme / Icons / Font
gtk3="on"

##--------- IP Address Configuration
# Website to ping for the public IP
public_ip_host="http://ident.me"

# Public IP timeout.
public_ip_timeout=2

# Desktop Environment version
de_version="on"

##--------- Disk Configuration
# Which disks to display.
disk_show=('/')

# Disk subtitle.
disk_subtitle="mount"

# Disk percent.
disk_percent="on"

##--------- Text Options
# Toggle bold text
bold="on"

# Enable/Disable Underline
underline_enabled="on"

# Underline character
underline_char="‚îÄ"

# Info Separator
separator="‚Üí"

##--------- Color Blocks
# Color block range
block_range=(0 15)

# Toggle color blocks
color_blocks="off"  # Disabled for cleaner look

# Color block width in spaces
block_width=3

# Color block height in lines
block_height=1

# Color Alignment
col_offset="auto"

##--------- Progress Bars
# Bar characters
bar_char_elapsed="‚îÄ"
bar_char_total="‚ïê"

# Toggle Bar border
bar_border="on"

# Progress bar length in spaces
bar_length=15

# Progress bar colors
bar_color_elapsed="4"  # Blue
bar_color_total="6"    # Cyan

# Info display
cpu_display="off"
memory_display="off"
battery_display="off"
disk_display="off"

##--------- Ascii Options
# Ascii distro
ascii_distro="auto"

# Ascii Colors - BLUX10K color scheme
ascii_colors=(4 6 2 3 1 5 7)

# Bold ascii logo
ascii_bold="on"

# Custom BLUX10K ASCII art
ascii_art_blux10k() {
    cat << 'EOF'
    
    ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñë‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñà‚ñÄ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÑ‚ñà
    ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñë‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñÑ‚ñÄ‚ñÑ ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñë‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñÄ‚ñÄ‚ñà‚ñë‚ñë‚ñà‚ñë‚ñë‚ñÄ‚ñÄ‚ñà‚ñë‚ñë‚ñà‚ñë‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñë‚ñà
    ‚ñë‚ñÄ‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë ‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ
    
EOF
}

# Use BLUX10K ASCII art when ascii_distro is set to blux10k
if [[ "$ascii_distro" == "blux10k" ]]; then
    ascii_art="ascii_art_blux10k"
fi

##--------- Image Options
# Image loop
image_loop="off"

# Thumbnail directory
thumbnail_dir="${XDG_CACHE_HOME:-${HOME}/.cache}/thumbnails/neofetch"

# Crop mode
crop_mode="normal"

# Crop offset
crop_offset="center"

# Image size
image_size="auto"

# Image offsets
yoffset=0
xoffset=0

# Image background color
background_color=""

##--------- Misc Options
# Stdout mode
stdout="off"

# Suppress function output
suppress_small="on"

# ============================================================================
# BLUX10K SPECIFIC SETTINGS
# ============================================================================

# Enable BLUX10K custom modules
blux10k_custom_info="on"

# Show development tools status
blux10k_show_dev_tools="on"

# Show terminal enhancements status
blux10k_show_terminal_enhancements="on"

# BLUX10K performance mode (reduces output for faster display)
blux10k_performance_mode="auto"

# BLUX10K Help Integration
blux10k_show_help_hint="on"

# ============================================================================
# HELPER FUNCTIONS FOR BLUX10K INTEGRATION
# ============================================================================

# Function to display BLUX10K neofetch help
blux10k_neofetch_help() {
    echo ""
    echo "$(color 4)‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "$(color 4)‚ïë                   BLUX10K NEOFETCH v4.0.0                      ‚ïë"
    echo "$(color 4)‚ïë               Enhanced System Information                      ‚ïë"
    echo "$(color 4)‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "$(color 6)Usage:"
    echo "  neofetch                          - Display system info with BLUX10K style"
    echo "  neofetch --config ~/.config/neofetch/b10k.neofetch.conf"
    echo "  neofetch --help                   - Show neofetch options"
    echo "  neofetch --blux10k-help           - Show BLUX10K specific help"
    echo ""
    echo "$(color 2)Features:"
    echo "  ‚Ä¢ Performance optimized display"
    echo "  ‚Ä¢ Context-aware information"
    echo "  ‚Ä¢ Development tools status"
    echo "  ‚Ä¢ Terminal environment details"
    echo "  ‚Ä¢ Custom BLUX10K color scheme"
    echo "  ‚Ä¢ System readiness check"
    echo "  ‚Ä¢ Caching for faster display"
    echo ""
    echo "$(color 3)Performance Options:"
    echo "  --perf-mode [auto|on|off]         - Control performance optimizations"
    echo "  --no-cache                        - Disable caching"
    echo "  --simple                          - Minimal output"
    echo ""
    echo "$(color 1)Display Options:"
    echo "  --ascii                           - Force ASCII art display"
    echo "  --blux10k-ascii                   - Show BLUX10K ASCII art"
    echo "  --compact                         - Compact layout"
    echo ""
    echo "$(color 5)Information Sections:"
    echo "  --show-all                        - Show all information"
    echo "  --hide-dev-tools                  - Hide development tools"
    echo "  --hide-term-enhance               - Hide terminal enhancements"
    echo "  --show-performance                - Show performance metrics"
    echo ""
    echo "$(color 4)Related Commands:"
    echo "  b10k --help                       - Show all BLUX10K commands"
    echo "  fastfetch                         - Faster alternative"
    echo "  p10k-show-config                  - Show Powerlevel10k config"
    echo "  zsh-health                        - ZSH diagnostics"
    echo ""
}

# Function to handle BLUX10K specific arguments
handle_blux10k_args() {
    case "$1" in
        --blux10k-help)
            blux10k_neofetch_help
            exit 0
            ;;
        --perf-mode)
            blux10k_performance_mode="$2"
            shift
            ;;
        --no-cache)
            blux10k_cache_enabled="off"
            ;;
        --simple)
            blux10k_performance_mode="on"
            color_blocks="off"
            ;;
        --blux10k-ascii)
            ascii_distro="blux10k"
            ;;
        --compact)
            gap=1
            blux10k_performance_mode="on"
            ;;
        --show-all)
            blux10k_performance_mode="off"
            ;;
        --hide-dev-tools)
            blux10k_show_dev_tools="off"
            ;;
        --hide-term-enhance)
            blux10k_show_terminal_enhancements="off"
            ;;
        --show-performance)
            # Already shown by default
            ;;
    esac
}

# Apply performance mode settings
apply_performance_mode() {
    case "$blux10k_performance_mode" in
        on)
            # Minimal output
            blux10k_show_dev_tools="off"
            blux10k_show_terminal_enhancements="off"
            color_blocks="off"
            gap=1
            ;;
        off)
            # Full output
            blux10k_show_dev_tools="on"
            blux10k_show_terminal_enhancements="on"
            color_blocks="on"
            gap=3
            ;;
        auto)
            # Auto-detect based on terminal size
            if [[ -t 1 ]] && (( COLUMNS < 100 )); then
                blux10k_performance_mode="on"
                apply_performance_mode
            fi
            ;;
    esac
}

# ============================================================================
# INITIALIZATION
# ============================================================================

# Create cache directory
mkdir -p "${blux10k_cache_dir}"

# Apply performance mode
apply_performance_mode

# Check for BLUX10K integration
if [[ -n "$BLUX10K_VERSION" ]] || [[ -f "$HOME/.config/blux10k/version" ]]; then
    # BLUX10K environment detected
    :
else
    echo "Note: BLUX10K environment not fully detected. Some features may be limited."
fi

# Load custom configurations
if [[ -f "$HOME/.config/neofetch/b10k.local.conf" ]]; then
    source "$HOME/.config/neofetch/b10k.local.conf"
fi

# Final message (only in verbose mode)
if [[ "$blux10k_performance_mode" != "on" ]]; then
    echo "BLUX10K Neofetch v4.0.0 loaded" >&2
fi
